<!DOCTYPE html>






<html class="theme-next muse use-motion" lang="zh-Hans">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="theme-color" content="#222">









  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />


















  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







  <link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

  <link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="FTP/Translated," />





  <link rel="alternate" href="/atom.xml" title="春暖花开" type="application/atom+xml" />






  <meta name="description" content="FTP（文件传输协议）是一个较老且最常用的标准网络协议，用于在两台计算机之间通过网络上传/下载文件。然而， FTP 最初的时候并不安全，因为它仅通过用户凭证（用户名和密码）传输数据，没有进行加密。
警告：如果你打算使用 FTP， 需要考虑通过 SSL/TLS（将在下篇文章中讨论）配置 FTP 连接。否则，使用安全 FTP，比如 SFTP 会更好一些。
推荐阅读：如何在 CentOS 7 中安装并保">
  <meta property="og:type" content="article">
  <meta property="og:title" content="如何在 Ubuntu 下安装和配置 FTP 服务器">
  <meta property="og:url" content="http://ucasfl.me/2017/03/18/How-to-Install-and-configure-FTP-in-Ubuntu/index.html">
  <meta property="og:site_name" content="春暖花开">
  <meta property="og:description" content="FTP（文件传输协议）是一个较老且最常用的标准网络协议，用于在两台计算机之间通过网络上传/下载文件。然而， FTP 最初的时候并不安全，因为它仅通过用户凭证（用户名和密码）传输数据，没有进行加密。
警告：如果你打算使用 FTP， 需要考虑通过 SSL/TLS（将在下篇文章中讨论）配置 FTP 连接。否则，使用安全 FTP，比如 SFTP 会更好一些。
推荐阅读：如何在 CentOS 7 中安装并保">
  <meta property="og:image" content="http://www.tecmint.com/wp-content/uploads/2017/02/Verify-FTP-Login-in-Ubuntu.png">
  <meta property="og:image" content="http://www.tecmint.com/wp-content/uploads/2017/02/FTP-User-Home-Directory-Login.png">
  <meta property="og:updated_time" content="2017-09-02T04:38:28.983Z">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="如何在 Ubuntu 下安装和配置 FTP 服务器">
  <meta name="twitter:description" content="FTP（文件传输协议）是一个较老且最常用的标准网络协议，用于在两台计算机之间通过网络上传/下载文件。然而， FTP 最初的时候并不安全，因为它仅通过用户凭证（用户名和密码）传输数据，没有进行加密。
警告：如果你打算使用 FTP， 需要考虑通过 SSL/TLS（将在下篇文章中讨论）配置 FTP 连接。否则，使用安全 FTP，比如 SFTP 会更好一些。
推荐阅读：如何在 CentOS 7 中安装并保">
  <meta name="twitter:image" content="http://www.tecmint.com/wp-content/uploads/2017/02/Verify-FTP-Login-in-Ubuntu.png">



  <script type="text/javascript" id="hexo.configurations">
    var NexT = window.NexT || {};
    var CONFIG = {
      root: '/',
      scheme: 'Muse',
      version: '5.1.3',
      sidebar: {
        "position": "left",
        "display": "post",
        "offset": 12,
        "b2t": false,
        "scrollpercent": false,
        "onmobile": false
      },
      fancybox: true,
      tabs: true,
      motion: {
        "enable": true,
        "async": false,
        "transition": {
          "post_block": "fadeIn",
          "post_header": "slideDownIn",
          "post_body": "slideDownIn",
          "coll_header": "slideLeftIn",
          "sidebar": "slideUpIn"
        }
      },
      duoshuo: {
        userId: '0',
        author: '博主'
      },
      algolia: {
        applicationID: '',
        apiKey: '',
        indexName: '',
        hits: {
          "per_page": 10
        },
        labels: {
          "input_placeholder": "Search for Posts",
          "hits_empty": "We didn't find any results for the search: ${query}",
          "hits_stats": "${hits} results found in ${time} ms"
        }
      }
    };
  </script>



  <link rel="canonical" href="http://ucasfl.me/2017/03/18/How-to-Install-and-configure-FTP-in-Ubuntu/" />





  <title>如何在 Ubuntu 下安装和配置 FTP 服务器 | 春暖花开</title>









</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">






  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner">
        <div class="site-brand-wrapper">
          <div class="site-meta ">


            <div class="custom-logo-site-title">
              <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">春暖花开</span>
        <span class="logo-line-after"><i></i></span>
      </a>
            </div>

            <p class="site-subtitle">love, life, thinking, coding</p>

          </div>

          <div class="site-nav-toggle">
            <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
          </div>
        </div>

        <nav class="site-nav">



          <ul id="menu" class="menu">


            <li class="menu-item menu-item-home">
              <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
            </li>


            <li class="menu-item menu-item-archives">
              <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
            </li>



          </ul>



        </nav>



      </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">


            <div id="posts" class="posts-expand">








              <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">



                <div class="post-block">
                  <link itemprop="mainEntityOfPage" href="http://ucasfl.me/2017/03/18/How-to-Install-and-configure-FTP-in-Ubuntu/">

                  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Flynn">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

                  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="春暖花开">
    </span>


                  <header class="post-header">



                    <h1 class="post-title" itemprop="name headline">如何在 Ubuntu 下安装和配置 FTP 服务器</h1>


                    <div class="post-meta">
                      <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>

                      <span class="post-meta-item-text">发表于</span>

                      <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-18T10:13:07+08:00">
                2017/03/18
              </time>





                      </span>


                      <span class="post-category">
            
              <span class="post-meta-divider">|</span>

                      <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>

                      <span class="post-meta-item-text">分类于</span>


                      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/FTP/" itemprop="url" rel="index">
                    <span itemprop="name">FTP</span>
                      </a>
                      </span>




                      </span>




                      <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                      <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                      <a href="/2017/03/18/How-to-Install-and-configure-FTP-in-Ubuntu/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count gitment-comments-count" data-xid="/2017/03/18/How-to-Install-and-configure-FTP-in-Ubuntu/" itemprop="commentsCount"></span>
                </a>
                      </span>












                    </div>
                  </header>





                  <div class="post-body" itemprop="articleBody">





                    <p>FTP（文件传输协议）是一个较老且最常用的标准网络协议，用于在两台计算机之间通过网络上传/下载文件。然而， FTP 最初的时候并不安全，因为它仅通过用户凭证（用户名和密码）传输数据，没有进行加密。</p>
                    <p>警告：如果你打算使用 FTP， 需要考虑通过 SSL/TLS（将在下篇文章中讨论）配置 FTP 连接。否则，使用安全 FTP，比如 <a href="http://www.tecmint.com/sftp-command-examples/" target="_blank" rel="external">SFTP</a> 会更好一些。</p>
                    <p><strong>推荐阅读：</strong><a href="http://www.tecmint.com/install-ftp-server-in-centos-7/" target="_blank" rel="external">如何在 CentOS 7 中安装并保护 FTP 服务器</a></p>
                    <p>在这个教程中，我将向你们展示如何在 Ubuntu 中安装、配置并保护 FTP 服务器（VSFTPD 的全称是 “Very Secure FTP Deamon”），从而拥有强大的安全性，能够防范 FTP 漏洞。</p>
                    <h3 id="第一步：在-Ubuntu-中安装-VSFTPD-服务器"><a href="#第一步：在-Ubuntu-中安装-VSFTPD-服务器" class="headerlink" title="第一步：在 Ubuntu 中安装 VSFTPD 服务器"></a>第一步：在 Ubuntu 中安装 VSFTPD 服务器</h3>
                    <p>1、首先，我们需要更新系统安装包列表，然后像下面这样安装 VSFTPD 二进制包：</p>
                    <figure class="highlight q">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line">$ sudo apt-<span class="built_in">get</span> <span class="keyword">update</span></div><div class="line">$ sudo apt-<span class="built_in">get</span> install vsftpd</div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>2、一旦安装完成，初始情况下服务被禁用。因此，我们需要手动开启服务，同时，启动它使得在下次开机时能够自动开启服务：</p>
                    <figure class="highlight vala">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line">------------- On SystemD -------------</div><div class="line"><span class="meta"># systemctl start vsftpd</span></div><div class="line"><span class="meta"># systemctl enable vsftpd</span></div><div class="line">------------- On SysVInit -------------</div><div class="line"><span class="meta"># service vsftpd start</span></div><div class="line"><span class="meta"># chkconfig --level 35 vsftpd on</span></div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <a id="more"></a>
                    <p>3、接下来，如果你在服务器上启用了 <a href="http://www.tecmint.com/how-to-install-and-configure-ufw-firewall/" target="_blank" rel="external">UFW 防火墙</a>（默认情况下不启用），那么需要打开端口 20 和 21 —— FTP 守护进程正在监听它们——从而才能允许从远程机器访问 FTP 服务，然后，像下面这样添加新的防火墙规则：</p>
                    <figure class="highlight elixir">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line"><span class="variable">$ </span>sudo ufw allow <span class="number">20</span>/tcp</div><div class="line"><span class="variable">$ </span>sudo ufw allow <span class="number">21</span>/tcp</div><div class="line"><span class="variable">$ </span>sudo ufw status</div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <h3 id="第二步：在-Ubuntu-中配置并保护-VSFTPD-服务器"><a href="#第二步：在-Ubuntu-中配置并保护-VSFTPD-服务器" class="headerlink" title="第二步：在 Ubuntu 中配置并保护 VSFTPD 服务器"></a>第二步：在 Ubuntu 中配置并保护 VSFTPD 服务器</h3>
                    <p>4、让我们进行一些配置来设置和保护 FTP 服务器。首先，我们像下面这样创建一个原始配置文件 <code>/etc/vsftpd/vsftpd.conf</code> 的备份文件：</p>
                    <figure class="highlight stylus">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line">$ sudo cp /etc/vsftpd<span class="selector-class">.conf</span> /etc/vsftpd<span class="selector-class">.conf</span><span class="selector-class">.orig</span></div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>接下来，打开 vsftpd 配置文件。</p>
                    <figure class="highlight gams">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line"><span class="symbol">$</span> sudo vi /etc/vsftpd.conf</div><div class="line"><span class="keyword">OR</span></div><div class="line"><span class="symbol">$</span> sudo nano /etc/vsftpd.conf</div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>把下面的这些选项添加/改成所展示的值：</p>
                    <figure class="highlight ini">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line"><span class="attr">anonymous_enable</span>=<span class="literal">NO</span>             # 关闭匿名登录</div><div class="line"><span class="attr">local_enable</span>=<span class="literal">YES</span>		# 允许本地用户登录</div><div class="line"><span class="attr">write_enable</span>=<span class="literal">YES</span>		# 启用可以修改文件的 FTP 命令</div><div class="line"><span class="attr">local_umask</span>=<span class="number">022</span>		        # 本地用户创建文件的 umask 值</div><div class="line"><span class="attr">dirmessage_enable</span>=<span class="literal">YES</span>	        # 当用户第一次进入新目录时显示提示消息</div><div class="line"><span class="attr">xferlog_enable</span>=<span class="literal">YES</span>		# 一个存有详细的上传和下载信息的日志文件</div><div class="line"><span class="attr">connect_from_port_20</span>=<span class="literal">YES</span>        # 在服务器上针对 PORT 类型的连接使用端口 <span class="number">20</span>（FTP 数据）</div><div class="line"><span class="attr">xferlog_std_format</span>=<span class="literal">YES</span>          # 保持标准日志文件格式</div><div class="line"><span class="attr">listen</span>=<span class="literal">NO</span>   			# 阻止 vsftpd 在独立模式下运行</div><div class="line"><span class="attr">listen_ipv6</span>=<span class="literal">YES</span>		        # vsftpd 将监听 ipv6 而不是 IPv4，你可以根据你的网络情况设置</div><div class="line"><span class="attr">pam_service_name</span>=vsftpd         # vsftpd 将使用的 PAM 验证设备的名字</div><div class="line"><span class="attr">userlist_enable</span>=<span class="literal">YES</span>  	        # 允许 vsftpd 加载用户名字列表</div><div class="line"><span class="attr">tcp_wrappers</span>=<span class="literal">YES</span>  		# 打开 tcp 包装器</div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>5、现在，配置 VSFTPD ，基于用户列表文件 <code>/etc/vsftpd.userlist</code> 来允许或拒绝用户访问 FTP。</p>
                    <p>注意，在默认情况下，如果通过 <code>userlist_enable=YES</code> 启用了用户列表，且设置 <code>userlist_deny=YES</code> 时，那么，用户列表文件 <code>/etc/vsftpd.userlist</code> 中的用户是不能登录访问的。</p>
                    <p>但是，选项 <code>userlist_deny=NO</code> 则反转了默认设置，这种情况下只有用户名被明确列出在 <code>/etc/vsftpd.userlist</code> 中的用户才允许登录到 FTP 服务器。</p>
                    <figure class="highlight ini">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line"><span class="attr">userlist_enable</span>=<span class="literal">YES</span>                   # vsftpd 将会从所给的用户列表文件中加载用户名字列表</div><div class="line"><span class="attr">userlist_file</span>=/etc/vsftpd.userlist    # 存储用户名字的列表</div><div class="line"><span class="attr">userlist_deny</span>=<span class="literal">NO</span></div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>重要的是，当用户登录 FTP 服务器以后，他们将进入 chrooted 环境，即当在 FTP 会话时，其 root 目录将是其 home 目录。</p>
                    <p>接下来，我们来看一看两种可能的途径来设置 chrooted（本地 root）目录，正如下面所展示的。</p>
                    <p>6、这时，让我们添加/修改/取消这两个选项来<a href="http://www.tecmint.com/restrict-sftp-user-home-directories-using-chroot/" target="_blank" rel="external">将 FTP 用户限制在其 home 目录</a></p>
                    <figure class="highlight ini">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line"><span class="attr">chroot_local_user</span>=<span class="literal">YES</span></div><div class="line"><span class="attr">allow_writeable_chroot</span>=<span class="literal">YES</span></div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>选项 <code>chroot_local_user=YES</code> 意味着本地用户将进入 chroot 环境，当登录以后默认情况下是其 home 目录。</p>
                    <p>并且我们要知道，默认情况下，出于安全原因，VSFTPD 不允许 chroot 目录具有可写权限。然而，我们可以通过选项 <code>allow_writeable_chroot=YES</code> 来改变这个设置</p>
                    <p>保存文件然后关闭。现在我们需要重启 VSFTPD 服务从而使上面的这些更改生效：</p>
                    <figure class="highlight applescript">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line"><span class="comment">------------- On SystemD -------------</span></div><div class="line"><span class="comment"># systemctl restart vsftpd</span></div><div class="line"><span class="comment">------------- On SysVInit -------------</span></div><div class="line"><span class="comment"># service vsftpd restart</span></div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <h3 id="第三步：在-Ubuntu-上测试-VsFTP-服务器"><a href="#第三步：在-Ubuntu-上测试-VsFTP-服务器" class="headerlink" title="第三步：在 Ubuntu 上测试 VsFTP 服务器"></a>第三步：在 Ubuntu 上测试 VsFTP 服务器</h3>
                    <p>7、现在，我们通过使用下面展示的 <a href="http://www.tecmint.com/add-users-in-linux/" target="_blank" rel="external">useradd 命令</a>创建一个 FTP 用户来测试 FTP 服务器：</p>
                    <figure class="highlight elixir">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line"><span class="variable">$ </span>sudo useradd -m -c <span class="string">"Aaron Kili, Contributor"</span> -s /bin/bash aaronkilik</div><div class="line"><span class="variable">$ </span>sudo passwd aaronkilik</div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>然后，我们需要像下面这样使用 <a href="http://www.tecmint.com/echo-command-in-linux/" target="_blank" rel="external">echo 命令</a>和 tee 命令来明确地列出文件 <code>/etc/vsftpd.userlist</code> 中的用户 aaronkilik：</p>
                    <figure class="highlight awk">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line">$ echo <span class="string">"aaronkilik"</span> | sudo tee -a <span class="regexp">/etc/</span>vsftpd.userlist</div><div class="line">$ cat <span class="regexp">/etc/</span>vsftpd.userlist</div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>8、现在，是时候来测试上面的配置是否具有我们想要的功能了。我们首先测试匿名登录；我们可以从下面的输出中很清楚的看到，在这个 FTP 服务器中是不允许匿名登录的：</p>
                    <figure class="highlight css">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line"># <span class="selector-tag">ftp</span> 192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.102</span></div><div class="line"><span class="selector-tag">Connected</span> <span class="selector-tag">to</span> 192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.102</span>  (192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.102</span>).</div><div class="line">220 <span class="selector-tag">Welcome</span> <span class="selector-tag">to</span> <span class="selector-tag">TecMint</span><span class="selector-class">.com</span> <span class="selector-tag">FTP</span> <span class="selector-tag">service</span>.</div><div class="line"><span class="selector-tag">Name</span> (192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.102</span><span class="selector-pseudo">:aaronkilik)</span> : <span class="selector-tag">anonymous</span></div><div class="line">530 <span class="selector-tag">Permission</span> <span class="selector-tag">denied</span>.</div><div class="line"><span class="selector-tag">Login</span> <span class="selector-tag">failed</span>.</div><div class="line"><span class="selector-tag">ftp</span>&gt; <span class="selector-tag">bye</span></div><div class="line">221 <span class="selector-tag">Goodbye</span>.</div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>9、接下来，我们将测试，如果用户的名字没有在文件 <code>/etc/vsftpd.userlist</code> 中，是否能够登录。从下面的输出中，我们看到，这是不可以的：</p>
                    <figure class="highlight css">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line"># <span class="selector-tag">ftp</span> 192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.102</span></div><div class="line"><span class="selector-tag">Connected</span> <span class="selector-tag">to</span> 192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.102</span>  (192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.102</span>).</div><div class="line">220 <span class="selector-tag">Welcome</span> <span class="selector-tag">to</span> <span class="selector-tag">TecMint</span><span class="selector-class">.com</span> <span class="selector-tag">FTP</span> <span class="selector-tag">service</span>.</div><div class="line"><span class="selector-tag">Name</span> (192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.10</span><span class="selector-pseudo">:root)</span> : <span class="selector-tag">user1</span></div><div class="line">530 <span class="selector-tag">Permission</span> <span class="selector-tag">denied</span>.</div><div class="line"><span class="selector-tag">Login</span> <span class="selector-tag">failed</span>.</div><div class="line"><span class="selector-tag">ftp</span>&gt; <span class="selector-tag">bye</span></div><div class="line">221 <span class="selector-tag">Goodbye</span>.</div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>10、现在，我们将进行最后一项测试，来确定列在文件 <code>/etc/vsftpd.userlist</code> 文件中的用户登录以后，是否实际处于 home 目录。从下面的输出中可知，是这样的：</p>
                    <figure class="highlight css">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line"># <span class="selector-tag">ftp</span> 192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.102</span></div><div class="line"><span class="selector-tag">Connected</span> <span class="selector-tag">to</span> 192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.102</span>  (192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.102</span>).</div><div class="line">220 <span class="selector-tag">Welcome</span> <span class="selector-tag">to</span> <span class="selector-tag">TecMint</span><span class="selector-class">.com</span> <span class="selector-tag">FTP</span> <span class="selector-tag">service</span>.</div><div class="line"><span class="selector-tag">Name</span> (192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.102</span><span class="selector-pseudo">:aaronkilik)</span> : <span class="selector-tag">aaronkilik</span></div><div class="line">331 <span class="selector-tag">Please</span> <span class="selector-tag">specify</span> <span class="selector-tag">the</span> <span class="selector-tag">password</span>.</div><div class="line"><span class="selector-tag">Password</span>:</div><div class="line">230 <span class="selector-tag">Login</span> <span class="selector-tag">successful</span>.</div><div class="line"><span class="selector-tag">Remote</span> <span class="selector-tag">system</span> <span class="selector-tag">type</span> <span class="selector-tag">is</span> <span class="selector-tag">UNIX</span>.</div><div class="line"><span class="selector-tag">Using</span> <span class="selector-tag">binary</span> <span class="selector-tag">mode</span> <span class="selector-tag">to</span> <span class="selector-tag">transfer</span> <span class="selector-tag">files</span>.</div><div class="line"><span class="selector-tag">ftp</span>&gt; <span class="selector-tag">ls</span></div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p><a href="http://www.tecmint.com/wp-content/uploads/2017/02/Verify-FTP-Login-in-Ubuntu.png" target="_blank" rel="external"><br> <img src="http://www.tecmint.com/wp-content/uploads/2017/02/Verify-FTP-Login-in-Ubuntu.png" alt="Verify FTP Login in Ubuntu">
</a></p>
                    <p><em>在 Ubuntu 中确认 FTP 登录</em></p>
                    <p>警告：设置选项 <code>allow_writeable_chroot=YES</code> 是很危险的，特别是如果用户具有上传权限，或者可以 shell 访问的时候，很可能会出现安全问题。只有当你确切的知道你在做什么的时候，才可以使用这个选项。</p>
                    <p>我们需要注意，这些安全问题不仅会影响到 VSFTPD，也会影响让本地用户进入 chroot 环境的 FTP daemon。</p>
                    <p>因为这些原因，在下一步中，我将阐述一个更安全的方法，来帮助用户设置一个非可写本地 root 目录。</p>
                    <h3 id="第四步：在-Ubuntu-中配置-FTP-用户的-Home-目录"><a href="#第四步：在-Ubuntu-中配置-FTP-用户的-Home-目录" class="headerlink" title="第四步：在 Ubuntu 中配置 FTP 用户的 Home 目录"></a>第四步：在 Ubuntu 中配置 FTP 用户的 Home 目录</h3>
                    <p>11、现在，再次打开 VSFTPD 配置文件。</p>
                    <figure class="highlight gams">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line"><span class="symbol">$</span> sudo vi /etc/vsftpd.conf</div><div class="line"><span class="keyword">OR</span></div><div class="line"><span class="symbol">$</span> sudo nano /etc/vsftpd.conf</div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>然后像下面这样用 <code>#</code> 把不安全选项注释了：</p>
                    <figure class="highlight vala">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line"><span class="meta">#allow_writeable_chroot=YES</span></div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>接下来，为用户创建一个替代的本地 root 目录（aaronkilik，你的可能和这不一样），然后设置目录权限，取消其他所有用户对此目录的写入权限：</p>
                    <figure class="highlight arduino">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line">$ sudo <span class="built_in">mkdir</span> /<span class="built_in">home</span>/aaronkilik/ftp</div><div class="line">$ sudo chown nobody:nogroup /<span class="built_in">home</span>/aaronkilik/ftp</div><div class="line">$ sudo chmod a-w /<span class="built_in">home</span>/aaronkilik/ftp</div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>12、然后，在本地 root 目录下创建一个具有合适权限的目录，用户将在这儿存储文件：</p>
                    <figure class="highlight groovy">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line">$ sudo mkdir <span class="regexp">/home/</span>aaronkilik<span class="regexp">/ftp/</span>files</div><div class="line">$ sudo chown -R <span class="string">aaronkilk:</span>aaronkilik <span class="regexp">/home/</span>aaronkilik<span class="regexp">/ftp/</span>files</div><div class="line">$ sudo chmod -R <span class="number">0770</span> <span class="regexp">/home/</span>aaronkilik<span class="regexp">/ftp/</span>files/</div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>之后，将 VSFTPD 配置文件中的下面这些选项添加/修改为相应的值：</p>
                    <figure class="highlight ini">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line"><span class="attr">user_sub_token</span>=<span class="variable">$USER</span>          # 在本地 root 目录中插入用户名</div><div class="line"><span class="attr">local_root</span>=/home/<span class="variable">$USER</span>/ftp    # 定义各个用户的本地 root 目录</div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>保存文件并关闭。然后重启 VSFTPD 服务来使上面的设置生效：</p>
                    <figure class="highlight applescript">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line"><span class="comment">------------- On SystemD -------------</span></div><div class="line"><span class="comment"># systemctl restart vsftpd</span></div><div class="line"><span class="comment">------------- On SysVInit -------------</span></div><div class="line"><span class="comment"># service vsftpd restart</span></div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p>13、现在，让我们来最后检查一下，确保用户的本地 root 目录是我们在他的 Home 目录中创建的 FTP 目录。</p>
                    <figure class="highlight css">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre>
                          </td>
                          <td class="code">
                            <pre><div class="line"># <span class="selector-tag">ftp</span> 192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.102</span></div><div class="line"><span class="selector-tag">Connected</span> <span class="selector-tag">to</span> 192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.102</span>  (192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.102</span>).</div><div class="line">220 <span class="selector-tag">Welcome</span> <span class="selector-tag">to</span> <span class="selector-tag">TecMint</span><span class="selector-class">.com</span> <span class="selector-tag">FTP</span> <span class="selector-tag">service</span>.</div><div class="line"><span class="selector-tag">Name</span> (192<span class="selector-class">.168</span><span class="selector-class">.56</span><span class="selector-class">.10</span><span class="selector-pseudo">:aaronkilik)</span> : <span class="selector-tag">aaronkilik</span></div><div class="line">331 <span class="selector-tag">Please</span> <span class="selector-tag">specify</span> <span class="selector-tag">the</span> <span class="selector-tag">password</span>.</div><div class="line"><span class="selector-tag">Password</span>:</div><div class="line">230 <span class="selector-tag">Login</span> <span class="selector-tag">successful</span>.</div><div class="line"><span class="selector-tag">Remote</span> <span class="selector-tag">system</span> <span class="selector-tag">type</span> <span class="selector-tag">is</span> <span class="selector-tag">UNIX</span>.</div><div class="line"><span class="selector-tag">Using</span> <span class="selector-tag">binary</span> <span class="selector-tag">mode</span> <span class="selector-tag">to</span> <span class="selector-tag">transfer</span> <span class="selector-tag">files</span>.</div><div class="line"><span class="selector-tag">ftp</span>&gt; <span class="selector-tag">ls</span></div></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>
                    <p><a href="http://www.tecmint.com/wp-content/uploads/2017/02/FTP-User-Home-Directory-Login.png" target="_blank" rel="external"><br> <img src="http://www.tecmint.com/wp-content/uploads/2017/02/FTP-User-Home-Directory-Login.png" alt="FTP User Home Directory Login">
</a></p>
                    <p><em>FTP 用户 Home 目录登录</em></p>
                    <p>就是这样的！记得通过下面的评论栏来分享你关于这篇指导的想法，或者你也可以提供关于这一话题的任何重要信息。</p>
                    <p>最后但不是不重要，请不要错过我的下一篇文章，在下一篇文章中，我将阐述如何<a href="http://www.tecmint.com/secure-ftp-server-using-ssl-tls-on-ubuntu/" target="_blank" rel="external">使用 SSL/TLS 来保护连接到 Ubuntu 16.04/16.10 的 FTP 服务器</a>，在那之前，请始终关注我们。</p>
                    <hr>
                    <p>作者简介：</p>
                    <p>Aaron Kili 是 Linux 和 F.O.S.S 爱好者，即将成为 Linux SysAdmin 和网络开发人员，目前是 TecMint 的内容创作者，他喜欢在电脑上工作，并坚信分享知识。</p>
                    <hr>
                    <p>via: <a href="http://www.tecmint.com/install-ftp-server-in-ubuntu/" target="_blank" rel="external">http://www.tecmint.com/install-ftp-server-in-ubuntu/</a></p>
                    <p>作者：<a href="http://www.tecmint.com/author/aaronkili/" target="_blank" rel="external">Aaron Kili</a><br>译者：<a href="https://github.com/ucasFL" target="_blank" rel="external">ucasFL</a><br>校对：<a href="https://github.com/wxy" target="_blank"
                        rel="external">wxy</a></p>
                    <p>本文由 <a href="https://github.com/LCTT/TranslateProject" target="_blank" rel="external">LCTT</a> 原创编译，<a href="https://linux.cn/" target="_blank" rel="external">Linux中国</a> 荣誉推出</p>

                  </div>










                  <footer class="post-footer">

                    <div class="post-tags">

                      <a href="/tags/FTP-Translated/" rel="tag"># FTP/Translated</a>

                    </div>







                    <div class="post-nav">
                      <div class="post-nav-next post-nav-item">

                        <a href="/2017/03/16/Stack/" rel="next" title="栈">
                <i class="fa fa-chevron-left"></i> 栈
              </a>

                      </div>

                      <span class="post-nav-divider"></span>

                      <div class="post-nav-prev post-nav-item">

                        <a href="/2017/03/18/Free-Command-in-Linux/" rel="prev" title="Free：一个在 Linux 中检查内存使用情况的标准命令">
                Free：一个在 Linux 中检查内存使用情况的标准命令 <i class="fa fa-chevron-right"></i>
              </a>

                      </div>
                    </div>




                  </footer>
                </div>



              </article>



              <div class="post-spread">

              </div>
            </div>


          </div>






          <div class="comments" id="comments">

            <div id="gitment-container"></div>

          </div>





        </div>



        <div class="sidebar-toggle">
          <div class="sidebar-toggle-line-wrap">
            <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
            <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
            <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
          </div>
        </div>

        <aside id="sidebar" class="sidebar">

          <div class="sidebar-inner">




            <ul class="sidebar-nav motion-element">
              <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
                文章目录
              </li>
              <li class="sidebar-nav-overview" data-target="site-overview-wrap">
                站点概览
              </li>
            </ul>


            <section class="site-overview-wrap sidebar-panel">
              <div class="site-overview">
                <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">

                  <p class="site-author-name" itemprop="name">Flynn</p>
                  <p class="site-description motion-element" itemprop="description">高山仰止，景行行止</p>
                </div>

                <nav class="site-state motion-element">


                  <div class="site-state-item site-state-posts">

                    <a href="/archives/">
              
                  <span class="site-state-item-count">119</span>
                  <span class="site-state-item-name">日志</span>
                </a>
                  </div>





                  <div class="site-state-item site-state-categories">
                    <a href="/categories/index.html">
                  <span class="site-state-item-count">36</span>
                  <span class="site-state-item-name">分类</span>
                </a>
                  </div>





                  <div class="site-state-item site-state-tags">
                    <a href="/tags/index.html">
                  <span class="site-state-item-count">69</span>
                  <span class="site-state-item-name">标签</span>
                </a>
                  </div>


                </nav>


                <div class="feed-link motion-element">
                  <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
                </div>


                <div class="links-of-author motion-element">

                </div>









              </div>
            </section>


            <!--noindex-->
            <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
              <div class="post-toc">






                <div class="post-toc-content">
                  <ol class="nav">
                    <li class="nav-item nav-level-3"><a class="nav-link" href="#第一步：在-Ubuntu-中安装-VSFTPD-服务器"><span class="nav-number">1.</span> <span class="nav-text">第一步：在 Ubuntu 中安装 VSFTPD 服务器</span></a></li>
                    <li class="nav-item nav-level-3"><a class="nav-link" href="#第二步：在-Ubuntu-中配置并保护-VSFTPD-服务器"><span class="nav-number">2.</span> <span class="nav-text">第二步：在 Ubuntu 中配置并保护 VSFTPD 服务器</span></a></li>
                    <li class="nav-item nav-level-3"><a class="nav-link" href="#第三步：在-Ubuntu-上测试-VsFTP-服务器"><span class="nav-number">3.</span> <span class="nav-text">第三步：在 Ubuntu 上测试 VsFTP 服务器</span></a></li>
                    <li class="nav-item nav-level-3"><a class="nav-link" href="#第四步：在-Ubuntu-中配置-FTP-用户的-Home-目录"><span class="nav-number">4.</span> <span class="nav-text">第四步：在 Ubuntu 中配置 FTP 用户的 Home 目录</span></a></li>
                  </ol>
                </div>


              </div>
            </section>
            <!--/noindex-->




          </div>
        </aside>



      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
          <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
          <span class="author" itemprop="copyrightHolder">Flynn</span>


        </div>


        <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



        <span class="post-meta-divider">|</span>



        <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>













      </div>
    </footer>


    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>

    </div>




  </div>



  <script type="text/javascript">
    if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
      window.Promise = null;
    }
  </script>
























  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>




  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>




  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>




  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>




  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>




  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>






  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>







  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
  <script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>






  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>

































  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
























</body>

</html>